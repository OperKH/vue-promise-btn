!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("vue")):"function"==typeof define&&define.amd?define(["vue"],n):(e=e||self).VuePromiseBtn=n(e.Vue)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var n=function(e,n,t,i,r,o,s,a,d,p){"boolean"!=typeof s&&(d=a,a=s,s=!1);var u,c="function"==typeof t?t.options:t;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),i&&(c._scopeId=i),o?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=u):n&&(u=s?function(){n.call(this,p(this.$root.$options.shadowRoot))}:function(e){n.call(this,a(e))}),u)if(c.functional){var l=c.render;c.render=function(e,n){return u.call(n),l(e,n)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,u):[u]}return t}({render:function(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"spinner",style:this.style})},staticRenderFns:[]},void 0,{name:"Spinner",props:{color:{type:String,default:"#3498db"},size:{type:Number,default:18},width:{type:Number,default:4},duration:{type:String,default:"1s"}},computed:{style:function(){return{borderTopColor:this.color,width:this.size+"px",height:this.size+"px",borderWidth:this.width+"px",animationDuration:this.duration}}}},"data-v-cc3e8e04",!1,void 0,void 0,void 0),t=0,i=function(n){var i={listeners:{},init:function(r,o,s){var a,d=(a=o.value)===Object(a),p=r.$promiseBtnId=t++,u=d?o.value:{},c=Object.assign({},n,u),l=s.data.on&&s.data.on[c.action]&&(s.data.on[c.action]._withTask||s.data.on[c.action]._wrapper),f=function(e){return"string"==typeof e}(c.loader),h=r,v=null,b=!1,m=!1,w=function(){b&&m&&(v.show=!1,b=!1,m=!1,function(e,n){e.getAttribute("disabled")&&n.disableBtn&&e.removeAttribute("disabled"),e.classList.remove(n.btnLoadingClass)}(h,c))},y=function(){g=!1,c.showSpinner&&(m=!0,w())};if(i.listeners[p]={el:r,eventType:c.action,handler:l},r.removeEventListener(c.action,l),!l)throw new Error("Please, provide proper handler/action for promise-btn");if("submit"===c.action&&!(h=r.querySelector('[type="submit"]')))throw new Error("No submit button found");if(c.showSpinner){var _=function(n,t,i,r){var o=document.createElement("SPAN");n.appendChild(o);var s={el:o,data:{show:!1},props:{parent:{type:Object,default:function(){return i.context}}},render:t.componentRenderer(t)};if(r){var a=t.stringHTMLRenderer(t),d=e.compile(a);s=Object.assign({},s,{data:Object.assign({},s.data,{options:t}),render:d.render,staticRenderFns:d.staticRenderFns})}return s}(h,c,s,f);v=new e(_)}var g=!1;i.listener=function(e){if(!c.disableBtn||!g){var n,t=l(e),i="function"==typeof t?function(e){for(var n=e;"function"==typeof n;)n=n();return n}(t):t;!(n=i)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then||(g=!0,function(e,n){n.disableBtn&&e.setAttribute("disabled","disabled"),e.classList.add(n.btnLoadingClass)}(h,c),c.showSpinner&&(v.show=!0,setTimeout(function(){b=!0,w()},c.minTimeout)),i.then(y).catch(function(e){throw y(),e}))}}},bind:function(e,n,t){var r;(r=n.def).init.apply(r,arguments);var o=e.$promiseBtnId,s=i.listeners[o].eventType;e.addEventListener(s,i.listener)},unbind:function(e,n){var t=e.$promiseBtnId,r=i.listeners[t].eventType;e.removeEventListener(r,i.listener),delete i.listeners[t],delete e.$promiseBtnId}};return i},r={btnLoadingClass:"loading",showSpinner:!0,action:"click",disableBtn:!0,stringHTMLRenderer:function(e){return'\n  <span class="promise-btn__spinner-wrapper" \n        :class="{[options.spinnerHiddenClass]: !show || false}"\n        v-show="options.autoHideSpinnerWrapper ? show : true"\n  >\n    '+e.loader+"\n  </span>"},componentRenderer:function(e){return function(n){var t;return n("span",{class:(t={"promise-btn__spinner-wrapper":!0},t[e.spinnerHiddenClass]=!!e.spinnerHiddenClass&&!this.show,t),directives:[{name:"show",value:!e.autoHideSpinnerWrapper||this.show}]},[n(e.loader)])}},minTimeout:400,spinnerHiddenClass:"hidden",autoHideSpinnerWrapper:!1,loader:n};return{install:function(e,n){var t=Object.assign({},r,n);e.directive("promise-btn",i(t))},Spinner:n,setupVuePromiseBtn:i}});
